<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.54.0 with theme Tranquilpeak 0.4.3-SNAPSHOT">
<meta name="author" content="R doodles. Some ecology. Some physiology. Much fake data.">
<meta name="keywords" content="tech">
<meta name="description" content="This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means.">


<meta property="og:description" content="This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means.">
<meta property="og:type" content="article">
<meta property="og:title" content="Bootstrap confidence intervals when sample size is really small">
<meta name="twitter:title" content="Bootstrap confidence intervals when sample size is really small">
<meta property="og:url" content="/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
<meta property="twitter:url" content="/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
<meta property="og:site_name" content="R Doodles">
<meta property="og:description" content="This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means.">
<meta name="twitter:description" content="This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means.">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-06-01T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-06-01T00:00:00">
  
  
  
    
      <meta property="article:section" content="stats 101">
    
  
  
    
      <meta property="article:tag" content="confidence interval">
    
      <meta property="article:tag" content="fake data">
    
      <meta property="article:tag" content="generalized linear models">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@jwalkrunski">


  <meta name="twitter:creator" content="@jwalkrunski">










  <meta property="og:image" content="/images/fire.png">
  <meta property="twitter:image" content="/images/fire.png">


    <title>Bootstrap confidence intervals when sample size is really small</title>

    <link rel="icon" href="/favicon.png">
    

    

    <link rel="canonical" href="/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-118821125-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">R Doodles</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about">
    
    
    
      
        <img class="header-picture" src="/images/fire.png" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="/images/fire.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">R doodles. Some ecology. Some physiology. Much fake data.</h4>
        
          <h5 class="sidebar-profile-bio">Thoughts on R, statistical best practices, and teaching applied statistics to Biology majors.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="//github.com/middleprofessor">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stats.stackexchange.com/users/119435/jwalker">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-exchange"></i>
      
      <span class="sidebar-button-desc">CrossValidated</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://scholar.google.com/citations?user=W58TmakAAAAJ&amp;hl">
    
      <i class="sidebar-button-icon fa fa-lg fa-google"></i>
      
      <span class="sidebar-button-desc">Google Scholar</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.researchgate.net/profile/Jeffrey_Walker4/contributions">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Research Gate</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.middleprofessor.com">
    
      <i class="sidebar-button-icon fa fa-lg fa-university"></i>
      
      <span class="sidebar-button-desc">Research/Teaching</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Bootstrap confidence intervals when sample size is really small
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-06-01T00:00:00Z">
        
  June 1, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/stats-101">stats 101</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means. It is not dependent on any distribution. It can be used to compute CIs for statistics where no paramtric CI exists. And its (fairly) easy to implement!</p>
<p>I’ve been using the bootstrap to generate CIs for over 25 years and am embarrassed to admit that I don’t know how well it performs with small samples sizes…on the order of n = 5 or 10, which is really common in bench biology. A problem with small sample size is that any one sample may not be very representative of what the distribution looks like.</p>
<p>This is a small simulation to explore how well a bootstrap performs for estimating CIs of both means and the difference in means. The question pursued is: “do the CIs of a x% bootstrap interval actually cover the mean x% of the time?” The data simulate those in Figure 1F in <a href="https://www.nature.com/articles/s41467-019-14178-y">β4GALT1 controls β1 integrin function to govern thrombopoiesis and hematopoietic stem cell homeostasis</a>.</p>
<p>The data are platelet counts and look they come from a distribution with a strong right skew and variance proportional to the mean (poisson, negative binomial). I approximate the data by sampling from a negative binomial distribution. Then I ask, “does the distribution matter” and re-run the simulation by sampling from a normal distribution with heterogeneity in variance (equal to that in the two groups).</p>
<p>TL;DR – <a href="#plot">seee the plot</a> and go to the <a href="#summary">summary</a>.</p>
<div id="setup" class="section level1">
<h1>Setup</h1>
<pre class="r"><code>knitr::opts_chunk$set(echo = TRUE, message=FALSE)
# wrangling packages
library(here)
library(janitor)
library(readxl)
library(data.table)
library(stringr)

# analysis packages
library(MASS)
library(lmerTest)
library(emmeans)
library(boot)

# graphing packages
library(ggsci)
library(ggpubr)
library(ggforce)
library(cowplot)

here &lt;- here::here()
data_folder &lt;- &quot;content/data&quot;
output_folder &lt;- &quot;content/output&quot;

run_simulation &lt;- FALSE</code></pre>
</div>
<div id="import" class="section level1">
<h1>Import</h1>
<pre class="r"><code>file_folder &lt;- &quot;β4GALT1 controls β1 integrin function to govern thrombopoiesis and hematopoietic stem cell homeostasis&quot;
fn &lt;- &quot;41467_2019_14178_MOESM4_ESM.xlsx&quot;
file_path &lt;- here(data_folder, file_folder, fn)

# Fig 1F
fig1f &lt;- read_excel(file_path,
                    sheet = &quot;Figure 1&quot;,
                    range = &quot;I5:J47&quot;) %&gt;%
  clean_names()  %&gt;%
  data.table() %&gt;%
  na.omit() # git rid of blank row. there are no NA
fig1f[, treatment := word(x1, 1)]
fig1f[, treatment := factor(treatment, c(&quot;Control&quot;, &quot;b4GalT1-/-&quot;))]
setnames(fig1f, old=&quot;platelets_e14_5&quot;, new=&quot;platelets&quot;)
fig1f[, platelet_count := round(platelets*10^9)]</code></pre>
</div>
<div id="stripchart-with-mean-and-raw-95-cis" class="section level1">
<h1>Stripchart with mean and raw 95% CIs</h1>
<pre class="r"><code>fig1f_means &lt;- fig1f[, .(platelet_count = mean(platelet_count),
                         SD = sd(platelet_count),
                         SE = sd(platelet_count/sqrt(.N)),
                         N = .N)
                     , by = treatment]
fig1f_means[, lower := platelet_count + SE*qt(.025, (N-1))]
fig1f_means[, upper := platelet_count + SE*qt(.975, (N-1))]

set.seed(1)
gg_points &lt;- ggplot(data = fig1f, 
                 aes(x = treatment, y = platelet_count)) +
  geom_sina(alpha=0.4) +
  theme_pubr() +
  NULL

set.seed(1)
gg_raw &lt;- gg_points +
  geom_point(data = fig1f_means,
             aes(y = platelet_count),
             size = 3,
             color = c(&quot;#3DB7E9&quot;, &quot;#e69f00&quot;)) +
  geom_errorbar(data = fig1f_means,
                aes(ymin = lower, ymax = upper),
                width = 0.04,
                size = 1,
                color = c(&quot;#3DB7E9&quot;, &quot;#e69f00&quot;)) +
  NULL

#gg_raw</code></pre>
</div>
<div id="a-bootstrap-function" class="section level1">
<h1>A bootstrap function</h1>
<p>This function returns two sets of CIs for the 1) modeled means of the observed fit and the 2) parameters of the observed fit. The first set is from a residual bootstrap. This seems weird because if there is heterogeneity, then a residual bootstrap spreads this heterogeneity among all groups. The second is from a stratified bootstrap. But if the differences in sample variance is due to noise, then a stratified bootstrap will mimic this noise.</p>
<pre class="r"><code># # # # # # # # #
# This function returns two sets of CIs for the 1) modeld means of the observed fit
# and the 2) parameters of the observed fit. The first set is from a residual bootstrap.
# This seems weird because if there is heterogeneity, then a residual bootstrap spreads
# this heterogeneity among all groups. The second is from a stratified bootstrap
# # # # # # # # #
boot_lm_test &lt;- function(obs_fit,
                         n_boot = 1000,
                         ci = 0.95,
                         method = &quot;stratified&quot;){
  ci_lo &lt;- (1-ci)/2
  ci_hi &lt;- 1 - (1-ci)/2
  boot_dt &lt;- data.table(obs_fit$model)
  boot_dt[, id:=.I]
  x_label &lt;- names(obs_fit$xlevels)[1]
  group_first_row &lt;- boot_dt[, .(bfr = min(id)), by=get(x_label)][,bfr]

  obs_beta &lt;- coef(obs_fit)
  obs_error &lt;- residuals(obs_fit)
  obs_yhat &lt;- fitted(obs_fit)
  obs_y &lt;- obs_fit$model[,1]
  obs_x &lt;- obs_fit$model[,2]
  X &lt;- model.matrix(obs_fit)
  xtxixt &lt;- solve(t(X)%*%X)%*%t(X)
  N &lt;- nrow(obs_fit$model)
  inc_resid &lt;- 1:N
  inc_strat &lt;- 1:N
  beta_resid &lt;- matrix(NA, nrow=n_boot, ncol=length(obs_beta))
  beta_strat &lt;- matrix(NA, nrow=n_boot, ncol=length(obs_beta))
  mu_resid &lt;- matrix(NA, nrow=n_boot, ncol=length(obs_beta))
  mu_strat &lt;- matrix(NA, nrow=n_boot, ncol=length(obs_beta))
  for(iter in 1:n_boot){

    # y_resamp_residuals &lt;- obs_yhat + obs_error[inc_resid]
    # beta_resid[iter,] &lt;- (xtxixt%*%y_resamp_residuals)[,1]
    # mu_resid[iter, ] &lt;- (X%*%beta_resid[iter,])[group_first_row, 1]
    
    y_resamp_strat &lt;- obs_y[inc_strat]
    beta_strat[iter,] &lt;- (xtxixt%*%y_resamp_strat)[,1]
    mu_strat[iter, ] &lt;- (X%*%beta_strat[iter,])[group_first_row, 1]
    
    inc_resid &lt;- sample(1:N, replace = TRUE)
    inc_strat &lt;- with(boot_dt, ave(id, get(x_label), FUN=function(x) {sample(x, replace=TRUE)}))
  }
  
  # ci_resid_beta &lt;- apply(beta_resid, 2, quantile, c(ci_lo, ci_hi))
  # ci_resid_mu &lt;- apply(mu_resid, 2, quantile, c(ci_lo, ci_hi))
  ci_strat_mu &lt;- apply(mu_strat, 2, quantile, c(ci_lo, ci_hi))
  ci_strat_beta &lt;- apply(beta_strat, 2, quantile, c(ci_lo, ci_hi))
  
  return(list(
    # ci_resid_beta = ci_resid_beta,
    # ci_resid_mu = ci_resid_mu,
    ci_strat_beta = ci_strat_beta,
    ci_strat_mu = ci_strat_mu
  ))
}</code></pre>
</div>
<div id="bootstrap-cis" class="section level1">
<h1>Bootstrap CIs</h1>
<pre class="r"><code>m1 &lt;- lm(platelet_count ~ treatment, data = fig1f)
m1_boot &lt;- boot_lm_test(m1)

fig1f_means[, lower.boot := m1_boot$ci_strat_mu[&quot;2.5%&quot;,]]
fig1f_means[, upper.boot := m1_boot$ci_strat_mu[&quot;97.5%&quot;,]]

set.seed(1)
gg_boot &lt;- gg_points +
  geom_point(data = fig1f_means,
             aes(y = platelet_count),
             size = 3,
             color = c(&quot;#3DB7E9&quot;, &quot;#e69f00&quot;)) +
  geom_errorbar(data = fig1f_means,
                aes(ymin = lower.boot, ymax = upper.boot),
                width = 0.04,
                size = 1,
                color = c(&quot;#3DB7E9&quot;, &quot;#e69f00&quot;)) +
  NULL

#gg_boot</code></pre>
</div>
<div id="plot" class="section level1">
<h1>plot of data, raw CIs, bootstrap CIs</h1>
<pre class="r"><code>plot_grid(gg_raw, gg_boot, ncol=2, labels = &quot;AUTO&quot;)</code></pre>
<div class="figure"><span id="fig:plot"></span>
<img src="/post/2020-06-01-bootstrap-confidence-intervals-when-sample-size-is-really-small_files/figure-html/plot-1.png" alt="A. Raw 95% CI, B. Bootstrap 95% CI" width="672" />
<p class="caption">
Figure 1: A. Raw 95% CI, B. Bootstrap 95% CI
</p>
</div>
<p>Not a big difference.</p>
</div>
<div id="simulation" class="section level1">
<h1>Simulation</h1>
<pre class="r"><code>boot_sim &lt;- function(
  mu, # mean of each level
  model = &quot;nb&quot;, # distribution of the data, normal or nb
  theta = 1, #theta for nb
  sigma = 1, # sd of each level for normal
  beta, # coefficients of model
  n_sim = 1000, # iterations of simulation
  n_boot = 1000, # number of bootstrap resamples
  n_list = 30, # vector of sample sizes per level. Whole sim run for each n
  method = &quot;stratified&quot; # stratified, residual, or both
){
  k &lt;- length(mu)
  treatment_levels &lt;- c(&quot;cn&quot;, paste0(&quot;tr&quot;, 1:(k-1)))

  coverage_table_mu &lt;- data.table(group = names(mu))
  coverage_table_beta &lt;- data.table(parameter = names(beta))
  
  
  for(n in n_list){
    N &lt;- k*n
    # vector of parameters for sampling function
    sim_mu &lt;- rep(mu, each=n)
    sim_sigma &lt;- rep(sigma, each=n)
    
    fd &lt;- data.table(
      treatment = rep(treatment_levels, each=n)
    )
    
    boot_ci_strat_mu&lt;- matrix(FALSE, nrow = n_sim, ncol=k)
    boot_ci_strat_beta &lt;- matrix(FALSE, nrow = n_sim, ncol=k)
    
    for(iter in 1:n_sim){
      if(model==&quot;nb&quot;){
        fd[, y_fake := rnegbin(N, sim_mu, theta)]
      }
      if(model==&quot;normal&quot;){
        fd[, y_fake := rnorm(N, sim_mu, sim_sigma)]
      }
      
      fit_fake &lt;- lm(y_fake ~ treatment, data=fd)
      ci_list &lt;- boot_lm_test(fit_fake, 
                              n_boot = n_boot, 
                              ci=0.95,
                              method = method)
      ci_strat_i_mu &lt;- ci_list$ci_strat_mu
      ci_strat_i_beta &lt;- ci_list$ci_strat_beta
      
      boot_ci_strat_beta[iter,] &lt;- beta &gt; ci_strat_i_beta[1,] &amp; 
        beta &lt; ci_strat_i_beta[2,]
      boot_ci_strat_mu[iter,] &lt;- mu &gt; ci_strat_i_mu[1,] &amp; 
        mu &lt; ci_strat_i_mu[2,]
    }
    coverage_table_mu &lt;- cbind(coverage_table_mu,
                               x = apply(boot_ci_strat_mu, 2, sum)/n_sim*100)
    setnames(coverage_table_mu, &quot;x&quot;, paste0(&quot;n=&quot;, n))
    
    coverage_table_beta &lt;- cbind(coverage_table_beta,
                                 x = apply(boot_ci_strat_beta, 2, sum)/n_sim*100)
    setnames(coverage_table_beta, &quot;x&quot;, paste0(&quot;n=&quot;, n))
  }
  
  return(list(
    coverage_table_mu = coverage_table_mu,
    coverage_table_beta = coverage_table_beta
    )
  )
}</code></pre>
<pre class="r"><code># # # # # # # # #
# This script explores &quot;do the CIs of a x% bootstrap interval actually cover the mean x%
# of the time&quot;. The sample is from a negative binomial distribution so there is
# heterogeneity of variance.
# # # # # # # # #

set.seed(1)
n_sim &lt;- 2000
n_boot &lt;- 1000
n_list &lt;- c(5, 10, 20, 40, 80)

lm_obs &lt;- lm(platelet_count ~ treatment, data = fig1f)
lm_obs_sigma &lt;- summary(lm_obs)$sigma
glm_obs &lt;- glm.nb(platelet_count ~ treatment, data = fig1f)
glm_obs_fitted &lt;- glm_obs$fitted.values
glm_obs_theta  &lt;- glm_obs$theta

mu_levels &lt;- summary(emmeans(lm_obs, specs = &quot;treatment&quot;))[, &quot;emmean&quot;]
names(mu_levels) &lt;- summary(emmeans(lm_obs, specs = &quot;treatment&quot;))[, &quot;treatment&quot;]
beta &lt;- coef(lm_obs)
theta &lt;- glm_obs_theta
sigma_raw &lt;- fig1f_means[, SD]
names(sigma_raw) &lt;- fig1f_means[, treatment]</code></pre>
<pre class="r"><code>out_file &lt;- &quot;boot_ci-nb.Rds&quot;
save_file_path &lt;- here(output_folder, out_file)

if(run_simulation == TRUE){
  boot_ci_sim_nb &lt;- boot_sim(
    mu = mu_levels, # mean of each level
    model = &quot;nb&quot;, # distribution of the data, normal or nb
    theta = theta, #theta for nb
    sigma = sigma_raw, # sd of each level for normal
    beta = beta, # coefficients
    n_sim = n_sim, # iterations of simulation
    n_boot = n_boot, # number of bootstrap resamples
    n_list = n_list, # vector of sample sizes per level. Whole sim run for each n
    method = &quot;stratified&quot; # stratified, residual, or both
  )
  saveRDS(object = boot_ci_sim_nb, file = save_file_path)
}else{
  boot_ci_sim_nb &lt;- readRDS(save_file_path)
}

boot_ci_sim_nb$coverage_table_mu</code></pre>
<pre><code>##         group  n=5  n=10 n=20 n=40  n=80
## 1:    Control 80.6 86.15 90.4 92.2 94.20
## 2: b4GalT1-/- 79.4 87.10 91.0 92.3 93.55</code></pre>
<pre class="r"><code>boot_ci_sim_nb$coverage_table_beta</code></pre>
<pre><code>##              parameter   n=5  n=10 n=20  n=40  n=80
## 1:         (Intercept) 80.60 86.15 90.4 92.20 94.20
## 2: treatmentb4GalT1-/- 82.85 87.60 91.2 92.65 93.65</code></pre>
<pre class="r"><code>out_file &lt;- &quot;boot_ci-normal.Rds&quot;
save_file_path &lt;- here(output_folder, out_file)

if(run_simulation == TRUE){
  boot_ci_sim_normal &lt;- boot_sim(
    mu = mu_levels, # mean of each level
    model = &quot;normal&quot;, # distribution of the data, normal or nb
    theta = theta, #theta for nb
    sigma = sigma_raw, # sd of each level for normal
    beta = beta, # coefficients
    n_sim = n_sim, # iterations of simulation
    n_boot = n_boot, # number of bootstrap resamples
    n_list = n_list, # vector of sample sizes per level. Whole sim run for each n
    method = &quot;stratified&quot; # stratified, residual, or both
  )
  saveRDS(object = boot_ci_sim_normal, file = save_file_path)
}else{
  boot_ci_sim_normal &lt;- readRDS(save_file_path)
}

boot_ci_sim_normal$coverage_table_mu</code></pre>
<pre><code>##         group   n=5  n=10  n=20 n=40  n=80
## 1:    Control 83.55 89.20 92.65 94.3 94.80
## 2: b4GalT1-/- 84.50 89.95 92.40 93.9 95.85</code></pre>
<pre class="r"><code>boot_ci_sim_normal$coverage_table_beta</code></pre>
<pre><code>##              parameter   n=5  n=10  n=20  n=40 n=80
## 1:         (Intercept) 83.55 89.20 92.65 94.30 94.8
## 2: treatmentb4GalT1-/- 84.65 89.65 92.85 94.05 95.2</code></pre>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<div id="group-means-sampled-from-negative-binomial" class="section level2">
<h2>group means, sampled from negative binomial</h2>
<table>
<caption><span id="tab:summary-results-mu-nb">Table 1: </span>Coverage of the 95% bootstrap CI of the mean, for data sampled from a negative binomial distribution</caption>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">n=5</th>
<th align="right">n=10</th>
<th align="right">n=20</th>
<th align="right">n=40</th>
<th align="right">n=80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Control</td>
<td align="right">80.6</td>
<td align="right">86.15</td>
<td align="right">90.4</td>
<td align="right">92.2</td>
<td align="right">94.20</td>
</tr>
<tr class="even">
<td align="left">b4GalT1-/-</td>
<td align="right">79.4</td>
<td align="right">87.10</td>
<td align="right">91.0</td>
<td align="right">92.3</td>
<td align="right">93.55</td>
</tr>
</tbody>
</table>
</div>
<div id="coefficients-sampled-from-negative-binomial" class="section level2">
<h2>coefficients, sampled from negative binomial</h2>
<table>
<caption><span id="tab:summary-results-beta-nb">Table 2: </span>Coverage of the 95% bootstrap CI of the model parameters, for data sampled from a negative binomial distribution</caption>
<thead>
<tr class="header">
<th align="left">parameter</th>
<th align="right">n=5</th>
<th align="right">n=10</th>
<th align="right">n=20</th>
<th align="right">n=40</th>
<th align="right">n=80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">80.60</td>
<td align="right">86.15</td>
<td align="right">90.4</td>
<td align="right">92.20</td>
<td align="right">94.20</td>
</tr>
<tr class="even">
<td align="left">treatmentb4GalT1-/-</td>
<td align="right">82.85</td>
<td align="right">87.60</td>
<td align="right">91.2</td>
<td align="right">92.65</td>
<td align="right">93.65</td>
</tr>
</tbody>
</table>
</div>
<div id="group-means-sampled-from-normal" class="section level2">
<h2>group means, sampled from normal</h2>
<table>
<caption><span id="tab:summary-results-mu-normal">Table 3: </span>Coverage of the 95% bootstrap CI of the mean, for data sampled from normal distribution</caption>
<thead>
<tr class="header">
<th align="left">group</th>
<th align="right">n=5</th>
<th align="right">n=10</th>
<th align="right">n=20</th>
<th align="right">n=40</th>
<th align="right">n=80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Control</td>
<td align="right">83.55</td>
<td align="right">89.20</td>
<td align="right">92.65</td>
<td align="right">94.3</td>
<td align="right">94.80</td>
</tr>
<tr class="even">
<td align="left">b4GalT1-/-</td>
<td align="right">84.50</td>
<td align="right">89.95</td>
<td align="right">92.40</td>
<td align="right">93.9</td>
<td align="right">95.85</td>
</tr>
</tbody>
</table>
</div>
<div id="coefficients-sampled-from-normal" class="section level2">
<h2>coefficients, sampled from normal</h2>
<table>
<caption><span id="tab:summary-results-beta-normal">Table 4: </span>Coverage of the 95% bootstrap CI of the model parameters, for data sampled from a normal distribution</caption>
<thead>
<tr class="header">
<th align="left">parameter</th>
<th align="right">n=5</th>
<th align="right">n=10</th>
<th align="right">n=20</th>
<th align="right">n=40</th>
<th align="right">n=80</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">83.55</td>
<td align="right">89.20</td>
<td align="right">92.65</td>
<td align="right">94.30</td>
<td align="right">94.8</td>
</tr>
<tr class="even">
<td align="left">treatmentb4GalT1-/-</td>
<td align="right">84.65</td>
<td align="right">89.65</td>
<td align="right">92.85</td>
<td align="right">94.05</td>
<td align="right">95.2</td>
</tr>
</tbody>
</table>
<p>Huh. The bootstrap intervals are very…optimistic at sample sizes typical of bench biology. Yes, books on the bootstrap do cover small sample issues and potential solutions. But I’m surprised by how little I’ve seen references to this, or maybe I’ve just selectively filtered it out.</p>
</div>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/confidence-interval/">confidence interval</a>

  <a class="tag tag--primary tag--small" href="/tags/fake-data/">fake data</a>

  <a class="tag tag--primary tag--small" href="/tags/generalized-linear-models/">generalized linear models</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/05/what-is-the-consequence-of-normalizing-by-each-case-in-the-control/" data-tooltip="What is the consequence of normalizing by each case in the control?">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 <a href="https://github.com/middleprofessor">Jeffrey A. Walker</a>. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--disabled">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/05/what-is-the-consequence-of-normalizing-by-each-case-in-the-control/" data-tooltip="What is the consequence of normalizing by each case in the control?">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2020%2F06%2Fbootstrap-confidence-intervals-when-sample-size-is-really-small%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2020%2F06%2Fbootstrap-confidence-intervals-when-sample-size-is-really-small%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2020%2F06%2Fbootstrap-confidence-intervals-when-sample-size-is-really-small%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="/images/fire.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">R doodles. Some ecology. Some physiology. Much fake data.</h4>
    
      <div id="about-card-bio">Thoughts on R, statistical best practices, and teaching applied statistics to Biology majors.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Jeff Walker, Professor of Biological Sciences
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        University of Southern Maine, Portland, Maine, United States
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/06/bootstrap-confidence-intervals-when-sample-size-is-really-small/">
                <h3 class="media-heading">Bootstrap confidence intervals when sample size is really small</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jun 6, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This is part II of how to represent uncertainty in the mean response of each treatment level. A 1 SE bar, where the SE is computed for each group independently, is nearly universal in much of biology. Part I explains why I prefer confidence intervals to SE bars and explores several alternative methods for computing a CI. One alternative is a non-parametric bootstrap. I like the bootstrap – it is extremely useful for learning and teaching what “frequentist” means.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/05/what-is-the-consequence-of-normalizing-by-each-case-in-the-control/">
                <h3 class="media-heading">What is the consequence of normalizing by each case in the control?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  May 5, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Novel metabolic role for BDNF in pancreatic β-cell insulin secretion
library(tidyverse) ## ── Attaching packages ──────────────────────────────────────────────────── tidyverse 1.2.1 ── ## ✔ ggplot2 3.3.0 ✔ purrr 0.3.3 ## ✔ tibble 3.0.1 ✔ dplyr 0.8.5 ## ✔ tidyr 1.0.0 ✔ stringr 1.4.0 ## ✔ readr 1.3.1 ✔ forcats 0.4.0 ## ── Conflicts ─────────────────────────────────────────────────────── tidyverse_conflicts() ── ## ✖ dplyr::filter() masks stats::filter() ## ✖ dplyr::lag() masks stats::lag() library(data.table) ## ## Attaching package: &#39;data.table&#39; ## The following objects are masked from &#39;package:dplyr&#39;: ## ## between, first, last ## The following object is masked from &#39;package:purrr&#39;: ## ## transpose library(mvtnorm) library(lmerTest) ## Loading required package: lme4 ## Loading required package: Matrix ## ## Attaching package: &#39;Matrix&#39; ## The following objects are masked from &#39;package:tidyr&#39;: ## ## expand, pack, unpack ## ## Attaching package: &#39;lmerTest&#39; ## The following object is masked from &#39;package:lme4&#39;: ## ## lmer ## The following object is masked from &#39;package:stats&#39;: ## ## step normal response niter &lt;- 2000 n &lt;- 9 treatment_levels &lt;- c(&quot;cn&quot;, &quot;high&quot;, &quot;high_bdnf&quot;) insulin &lt;- data.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/04/melting-a-list-of-columns/">
                <h3 class="media-heading">Melting a list of columns</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Apr 4, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">An answer to this tweet “Are there any #Rstats tidy expeRts who’d be interested in improving the efficiency of this code that gathers multiple variables from wide to long?
This works but it’s not pretty. There must be a prettier way…&quot;
Wide data frame has three time points where participants answer two questions on two topics.
create data from original code #Simmed data Time1.Topic1.Question1 &lt;- rnorm(500) data &lt;- data.frame(Time1.Topic1.Question1) data$Time1.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
                <h3 class="media-heading">Analyzing longitudinal data -- a simple pre-post design</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Mar 3, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/02/using-wright-s-rules-and-a-dag-to-compute-the-bias-of-an-effect-when-we-measure-proxies-for-x-and-y/">
                <h3 class="media-heading">Using Wright&#39;s rules and a DAG to compute the bias of an effect when we measure proxies for X and Y</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This is a skeletal post to work up an answer to a twitter question using Wright’s rules of path models. Using this figure
from Panel A of a figure from Hernan and Cole. The scribbled red path coefficients are added
 the question is I want to know about A-&gt;Y but I measure A* and Y*. So in figure A, is the bias the backdoor path from A* to Y* through A and Y?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/11/nested-random-factors-in-mixed-multilevel-or-hierarchical-models/">
                <h3 class="media-heading">&#34;Nested&#34; random factors in mixed (multilevel or hierarchical) models</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Setup Import Models as nested using “tank” nested within “room” as two random intercepts (using lme4 to create the combinations) A safer (lme4) way to create the combinations of “room” and “tank”: as two random intercepts using “tank2” Don’t do this    This is a skeletal post to show the equivalency of different ways of thinking about “nested” factors in a mixed model. The data are measures of life history traits in lice that infect salmon.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/11/estimate-of-marginal-main-effects-instead-of-anova-for-factorial-experiments/">
                <h3 class="media-heading">Estimate of marginal (&#34;main&#34;) effects instead of ANOVA for factorial experiments</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Background Comparing marginal effects to main effect terms in an ANOVA table First, some fake data Comparison of marginal effects vs. “main” effects term of ANOVA table when data are balanced Comparison of marginal effects vs. “main” effects term of ANOVA table when data are unbalanced  When to estimate marginal effects   keywords: estimation, ANOVA, factorial, model simplification, conditional effects, marginal effects
Background I recently read a paper from a very good ecology journal that communicated the results of an ANOVA like that below (Table 1) using a statement similar to “The removal of crabs strongly decreased algae cover (\(F_{1,36} = 17.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/can-a-linear-model-reproduce-a-welch-t-test/">
                <h3 class="media-heading">Can a linear model reproduce a Welch t-test?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This doodle was motivated Jake Westfall’s answer to a Cross-Validated question.
The short answer is yes but most R scripts that I’ve found on the web are unsatisfying because only the t-value reproduces, not the df and p-value. Jake notes the reason for this in his answer on Cross-Validated.
To get the adjusted df, and the p-value associated with this, one can use the emmeans package by Russell Lenth, as he notes here.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/normalization-results-in-regression-to-the-mean/">
                <h3 class="media-heading">Normalization results in regression to the mean and inflated Type I error conditional on the reference values</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Fig 1C of the Replication Study: Melanoma exosomes educate bone marrow progenitor cells toward a pro-metastatic phenotype through MET uses an odd (to me) three stage normalization procedure for the quantified western blots. The authors compared blot values between a treatment (shMet cells) and a control (shScr cells) using GAPDH to normalize the values. The three stages of the normalization are
first, the value for the Antibody levels were normalized by the value of a reference (GAPDH) for each Set.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/a-comment-on-the-novel-transformation-of-the-response-in-senolytics-decrease-senescent-cells-in-humans-preliminary-report-from-a-clinical-trial-of-dasatinib-plus-quercetin-in-individuals-with-diabetic-kidney-disease/">
                <h3 class="media-heading">A comment on the novel transformation of the response in &#34; Senolytics decrease senescent cells in humans: Preliminary report from a clinical trial of Dasatinib plus Quercetin in individuals with diabetic kidney disease&#34;</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Motivation: https://pubpeer.com/publications/8DF6E66FEFAA2C3C7D5BD9C3FC45A2#2 and https://twitter.com/CGATist/status/1175015246282539009
tl;dr: Given the transformation done by the authors, for any response in day_0 that is unusually small, there is automatically a response in day_14 that is unusually big and vice-versa. Consequently, if the mean for day_0 is unusually small, the mean for day_14 is automatically unusually big, hence the elevated type I error with an unpaired t-test. The transformation is necessary and sufficient to produce the result (meaning even in conditions where a paired t-test isn’t needed, the transformation still produces elevated Type I error).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         40 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/Jackson%20copy%202.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2020\/06\/bootstrap-confidence-intervals-when-sample-size-is-really-small\/';
          
            this.page.identifier = '\/2020\/06\/bootstrap-confidence-intervals-when-sample-size-is-really-small\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'r-doodles';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



<script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </body>
</html>

