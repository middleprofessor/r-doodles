<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.54.0 with theme Tranquilpeak 0.4.3-SNAPSHOT">
<meta name="author" content="R doodles. Some ecology. Some physiology. Much fake data.">
<meta name="keywords" content="tech">
<meta name="description" content="A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including">


<meta property="og:description" content="A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including">
<meta property="og:type" content="article">
<meta property="og:title" content="Analyzing longitudinal data -- a simple pre-post design">
<meta name="twitter:title" content="Analyzing longitudinal data -- a simple pre-post design">
<meta property="og:url" content="/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
<meta property="twitter:url" content="/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
<meta property="og:site_name" content="R Doodles">
<meta property="og:description" content="A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including">
<meta name="twitter:description" content="A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including">
<meta property="og:locale" content="en-us">

  
    <meta property="article:published_time" content="2020-03-19T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-03-19T00:00:00">
  
  
  
    
      <meta property="article:section" content="stats 101">
    
  
  
    
      <meta property="article:tag" content="ancova">
    
      <meta property="article:tag" content="fake data">
    
      <meta property="article:tag" content="linear mixed model">
    
      <meta property="article:tag" content="NHST">
    
      <meta property="article:tag" content="power">
    
      <meta property="article:tag" content="pre-post">
    
      <meta property="article:tag" content="clda">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@jwalkrunski">


  <meta name="twitter:creator" content="@jwalkrunski">










  <meta property="og:image" content="/images/fire.png">
  <meta property="twitter:image" content="/images/fire.png">


    <title>Analyzing longitudinal data -- a simple pre-post design</title>

    <link rel="icon" href="/favicon.png">
    

    

    <link rel="canonical" href="/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="/css/style-nnm2spxvve8onlujjlegkkytaehyadd4ksxc1hyzzq9a2wvtrgbljqyulomn.min.css" />
    
    

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-118821125-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="4">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="/">R Doodles</a>
  </div>
  
    
      <a class="header-right-picture "
         href="/#about">
    
    
    
      
        <img class="header-picture" src="/images/fire.png" alt="Author&#39;s picture" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="4">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="/#about">
          <img class="sidebar-profile-picture" src="/images/fire.png" alt="Author&#39;s picture" />
        </a>
        <h4 class="sidebar-profile-name">R doodles. Some ecology. Some physiology. Much fake data.</h4>
        
          <h5 class="sidebar-profile-bio">Thoughts on R, statistical best practices, and teaching applied statistics to Biology majors.</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/categories">
    
      <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
      
      <span class="sidebar-button-desc">Categories</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/tags">
    
      <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
      
      <span class="sidebar-button-desc">Tags</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/archives">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Archives</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="//github.com/middleprofessor">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://stats.stackexchange.com/users/119435/jwalker">
    
      <i class="sidebar-button-icon fa fa-lg fa-stack-exchange"></i>
      
      <span class="sidebar-button-desc">CrossValidated</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://scholar.google.com/citations?user=W58TmakAAAAJ&amp;hl">
    
      <i class="sidebar-button-icon fa fa-lg fa-google"></i>
      
      <span class="sidebar-button-desc">Google Scholar</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.researchgate.net/profile/Jeffrey_Walker4/contributions">
    
      <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
      
      <span class="sidebar-button-desc">Research Gate</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://www.middleprofessor.com">
    
      <i class="sidebar-button-icon fa fa-lg fa-university"></i>
      
      <span class="sidebar-button-desc">Research/Teaching</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="4"
        class="
               hasCoverMetaIn
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title" itemprop="headline">
      Analyzing longitudinal data -- a simple pre-post design
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-03-19T00:00:00Z">
        
  March 19, 2020

      </time>
    
    
  
  
    <span>in</span>
    
      <a class="category-link" href="/categories/stats-101">stats 101</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              


<p>A skeletal response to a twitter question:</p>
<p>“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”</p>
<p>follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”</p>
<p>Here I compare five methods using fake pre-post data, including</p>
<ol style="list-style-type: decimal">
<li>lm-cov. A linear model with baseline as a covariate. This is “ANCOVA” in the ANOVA-world.</li>
<li>clda. constrained longitudinal data analysis (cLDA). A linear mixed model in which the intercept is constrained to be equal (no treatment effect at time 0).</li>
<li>rmanova. Repeated measures ANOVA.</li>
<li>lmm. A linear mixed model version of rmanova. A difference is the rmanova will use a sphericity correction.</li>
<li>two-way. Linear model with Treatment and Time and their interaction as fixed factors. Equivalent to a Two-way fixed effects ANOVA in ANOVA-world.</li>
</ol>
<p>I use a simulation to compute Type I error rate and Power. This is far from a comprehensive simulation. Like I said, its skeletal.</p>
<p>TL;DR. At the risk of concluding anything from a very skeletal simulation:</p>
<ul>
<li>lm-cov has best performance in since of combining control of Type I error and relative power</li>
<li>smaller SE in clda comes at a cost of relatively high Type I error but increased powers. Do with this what you will.</li>
<li>rmanova has smaller power than lm-cov</li>
</ul>
<p>Not included: I didn’t save the results necessary to plot type I error conditional on baseline difference, which is well controlled by lm-cov (and clda) but not by lmm or rmanova.</p>
<div id="libraries" class="section level1">
<h1>libraries</h1>
<pre class="r"><code>library(data.table)
library(nlme)
library(emmeans)
library(afex)
library(ggpubr)
library(ggsci)
library(cowplot)</code></pre>
</div>
<div id="simulation-functions" class="section level1">
<h1>simulation functions</h1>
<div id="pre-post-fake-data-generator" class="section level2">
<h2>pre-post fake data generator</h2>
<p>My general algorithm for creating pre-post data with a single post time point differs from how I create pre-post data with multiplee post time points.</p>
<pre class="r"><code>generate_pre_post &lt;- function(
  n = 6, # if vector then sample per group
  sigma_0 = 1, # error at time 0
  sigma_1 = 1, # error at time 1
  rho = 0.6, # correlation between time 0 and 1
  beta_0 = 10, # control mean at time 0
  beta_1 = 1, # treatment effect at time 1
  beta_2 = 5 # time effect at time 1
){
  
  if(length(n) == 1){n &lt;- rep(n,2)} # set n = n for all groups
  N &lt;- sum(n)
  
  fd &lt;- data.table(
    treatment = factor(rep(c(&quot;cn&quot;, &quot;tr&quot;), n))
  )
  X &lt;- model.matrix(~treatment, data=fd)
  
  z &lt;- rnorm(N) # z is the common factor giving correlation at time 0 and 1. This
  # is easier for me than making glucose_1 = glucose_0 + treatment + noise
  fd[, glucose_0 := beta_0 + sqrt(rho)*z + sqrt(1 - rho)*rnorm(N, sd=sigma_0)]
  fd[, glucose_1 := beta_0 + sqrt(rho)*z*sigma_1 + sqrt(1 - rho)*rnorm(N, sd=sigma_1) +
       X[,2]*beta_1 + # add treatment effect
       beta_2 # add time effect
     ]
  fd[, change := glucose_1 - glucose_0] # change score
  fd[, id := factor(1:.N)]
  return(fd)
}</code></pre>
</div>
<div id="test-fdg" class="section level2">
<h2>test FDG</h2>
<pre class="r"><code>fd &lt;- generate_pre_post(
  n = c(10^5, 10^5),
  sigma_0 = 1,
  sigma_1 = 2,
  rho = 0.6, 
  beta_0 = 10, 
  beta_1 = 1 
)

m1 &lt;- lm(glucose_1 ~ treatment, data = fd)
fd[, glucose_1_cond := coef(m1)[1] + residuals(m1)]
coef(summary(m1))</code></pre>
<pre><code>##               Estimate  Std. Error   t value Pr(&gt;|t|)
## (Intercept) 15.0086453 0.006318270 2375.4359        0
## treatmenttr  0.9873514 0.008935383  110.4991        0</code></pre>
<pre class="r"><code>cov(fd[, .SD, .SDcols=c(&quot;glucose_0&quot;, &quot;glucose_1_cond&quot;)])</code></pre>
<pre><code>##                glucose_0 glucose_1_cond
## glucose_0        1.00213       1.197850
## glucose_1_cond   1.19785       3.992034</code></pre>
<pre class="r"><code>cor(fd[, .SD, .SDcols=c(&quot;glucose_0&quot;, &quot;glucose_1_cond&quot;)])</code></pre>
<pre><code>##                glucose_0 glucose_1_cond
## glucose_0       1.000000       0.598885
## glucose_1_cond  0.598885       1.000000</code></pre>
<pre class="r"><code>coef(summary(lm(glucose_1 ~ glucose_0 + treatment, data=fd)))</code></pre>
<pre><code>##              Estimate  Std. Error   t value Pr(&gt;|t|)
## (Intercept) 3.0529788 0.036105062  84.55819        0
## glucose_0   1.1953072 0.003574099 334.43596        0
## treatmenttr 0.9911134 0.007155790 138.50511        0</code></pre>
</div>
<div id="fake-data-wide-to-long" class="section level2">
<h2>fake data wide to long</h2>
<pre class="r"><code>wide_to_long &lt;- function(
  dt, #data.table,
  measure_prefix = &quot;glucose&quot;
){
# measure _prefix is the prefix of the measurement columns that will be melted. A &quot;_&quot; between the prefix and a time value is assumed. So with measure vars like glucose_0, glucose_15, glucose_20, the measure prefix is &quot;glucose&quot;
  dt &lt;- data.table(dt)
  dt_long &lt;- melt(dt, 
                  id.vars=c(&quot;treatment&quot;, &quot;id&quot;), 
                  measure.vars=patterns(paste0(measure_prefix, &quot;_&quot;)), 
                  variable.name = &quot;time&quot;,
                  value.name = measure_prefix)
  return(dt_long)
}</code></pre>
</div>
</div>
<div id="fit-model-functions" class="section level1">
<h1>Fit model functions</h1>
<div id="two-way-anova" class="section level2">
<h2>two-way anova</h2>
<pre class="r"><code>two_way &lt;- function(dt_long){
  fit &lt;- lm(glucose ~ time*treatment, data=dt_long)
  return(fit)
}</code></pre>
</div>
<div id="repeated-measures-anova" class="section level2">
<h2>repeated measures anova</h2>
<pre class="r"><code>rmanova &lt;- function(dt_long){
  fit &lt;- aov_4(glucose ~ time*treatment + (time|id),
               data=dt_long)
  return(fit)
}</code></pre>
</div>
<div id="linear-model-with-baseline-as-covariate" class="section level2">
<h2>linear model with baseline as covariate</h2>
<pre class="r"><code>lm_cov &lt;- function(dt){
  fit &lt;- lm(glucose_1 ~ glucose_0 + treatment, data = dt)
  return(fit)
}</code></pre>
</div>
<div id="linear-mixed-model" class="section level2">
<h2>linear mixed model</h2>
<pre class="r"><code>lmm &lt;- function(dt_long){
  fit &lt;- lme(glucose ~ time*treatment,
             random = ~1|id,
             data = dt_long,
             weights = varIdent(form= ~ 1 | time),
             correlation= corSymm(form=~ 1 | id))
  return(fit)
}</code></pre>
</div>
<div id="clda-functions" class="section level2">
<h2>cLDA functions</h2>
<p>Two equivalent functions for CLDA</p>
<div id="clda-1" class="section level3">
<h3>clda-1</h3>
<pre class="r"><code>clda1 &lt;- function(dt_long){
  design &lt;- model.matrix( ~ time + treatment:time, data = dt_long)
  # remove intercept column and effect of tr at time 0
  X &lt;- design[, -c(1, which(colnames(design) == &quot;timeglucose_0:treatmenttr&quot;))]
  colnames(X)[2] &lt;- &quot;timeglucose_1_treatmenttr&quot;
  dt_long_x &lt;- cbind(dt_long, X)
  form &lt;- formula(paste0(&quot;glucose ~ &quot;, paste(colnames(X), collapse = &quot; + &quot;)))
  fit &lt;- gls(form,
            data = dt_long_x,
            weights = varIdent(form= ~ 1 | time),
            correlation= corSymm(form=~ 1| id))
  return(fit)
}</code></pre>
</div>
<div id="clda-2" class="section level3">
<h3>clda-2</h3>
<pre class="r"><code>clda2 &lt;- function(dt_long){
  dt_clda &lt;- copy(dt_long)
  dt_clda[, time.treatment := ifelse(time != &quot;glucose_0&quot; &amp; treatment==&quot;tr&quot;, paste0(time, &quot;:tr&quot;), &quot;cont&quot;)]
  dt_clda[, time.treatment := factor(time.treatment, c(&quot;cont&quot;,&quot;glucose_1:tr&quot;))]
  fit &lt;- gls(glucose ~ time + time.treatment,
            data = dt_clda,
            weights = varIdent(form= ~ 1 | time),
            correlation= corSymm(form=~ 1| id))
  return(fit)
}</code></pre>
</div>
</div>
<div id="test-functions" class="section level2">
<h2>test functions</h2>
<p>Some equivalents</p>
<ol style="list-style-type: decimal">
<li>cLDA is equivalent estimate to the linear model with baseline covariate but has a smaller standard error.</li>
<li>the two-way (fixed) ANOVA and lmm have equivalent estimates but SE is larger</li>
<li>the lmm and rmanova have the same p-value (assuming sphericity)</li>
</ol>
<pre class="r"><code>fd &lt;- generate_pre_post(
  n = 6,
  sigma_0 = 1,
  sigma_1 = 1,
  rho = 0.6, 
  beta_0 = 10, 
  beta_1 = 1 
)

fd_long &lt;- wide_to_long(fd,
                        measure_prefix = &quot;glucose&quot;
                        )

m1 &lt;- lm_cov(fd)
m2 &lt;- clda1(fd_long)
m3 &lt;- clda2(fd_long)
m4 &lt;- lmm(fd_long)
m5 &lt;- two_way(fd_long)
m6 &lt;- rmanova(fd_long)</code></pre>
<p>linear model with baseline covariate</p>
<pre class="r"><code>coef(summary(m1))</code></pre>
<pre><code>##              Estimate Std. Error  t value   Pr(&gt;|t|)
## (Intercept) 9.4423880  3.3526784 2.816372 0.02016613
## glucose_0   0.5799923  0.3490826 1.661476 0.13098439
## treatmenttr 0.7087883  0.4448445 1.593340 0.14554812</code></pre>
<p>cLDA (both R methods)</p>
<pre class="r"><code>coef(summary(m2))</code></pre>
<pre><code>##                               Value Std.Error   t-value      p-value
## (Intercept)               9.6663085 0.1921116 50.316108 2.223746e-23
## timeglucose_1             5.3824640 0.3053176 17.629063 4.601669e-14
## timeglucose_1_treatmenttr 0.7087883 0.4164331  1.702046 1.035060e-01</code></pre>
<pre class="r"><code>coef(summary(m3))</code></pre>
<pre><code>##                                Value Std.Error   t-value      p-value
## (Intercept)                9.6663085 0.1921116 50.316108 2.223746e-23
## timeglucose_1              5.3824640 0.3053176 17.629063 4.601669e-14
## time.treatmentglucose_1:tr 0.7087883 0.4164331  1.702046 1.035060e-01</code></pre>
<p>two-way (fixed effect) linear model</p>
<pre class="r"><code>coef(summary(m5))</code></pre>
<pre><code>##                            Estimate Std. Error    t value     Pr(&gt;|t|)
## (Intercept)               9.5630065  0.3101326 30.8352174 2.449397e-18
## timeglucose_1             5.4258517  0.4385937 12.3710192 7.923275e-11
## treatmenttr               0.2066040  0.4385937  0.4710601 6.426952e-01
## timeglucose_1:treatmenttr 0.6220131  0.6202652  1.0028179 3.279282e-01</code></pre>
<p>linear mixed model</p>
<pre class="r"><code>coef(summary(m4))</code></pre>
<pre><code>##                               Value Std.Error DF    t-value      p-value
## (Intercept)               9.5630065 0.2811776 10 34.0105547 1.142426e-11
## timeglucose_1             5.4258517 0.3172619 10 17.1021224 9.855274e-09
## treatmenttr               0.2066040 0.3976452 10  0.5195688 6.146692e-01
## timeglucose_1:treatmenttr 0.6220131 0.4486761 10  1.3863299 1.957756e-01</code></pre>
<p>repeated measures ANOVA</p>
<pre class="r"><code>summary(m6)</code></pre>
<pre><code>## 
## Univariate Type III Repeated-Measures ANOVA Assuming Sphericity
## 
##                Sum Sq num Df Error SS den Df   F value    Pr(&gt;F)    
## (Intercept)    3770.9      1   8.5222     10 4424.7551 1.436e-14 ***
## treatment         1.6      1   8.5222     10    1.8863    0.1996    
## time            197.5      1   3.0197     10  653.9468 1.919e-10 ***
## treatment:time    0.6      1   3.0197     10    1.9219    0.1958    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="simulations" class="section level1">
<h1>simulations</h1>
<div id="single-post-time-point-pre-post" class="section level2">
<h2>single post time point (“pre-post”)</h2>
<pre class="r"><code>simulate_pre_post &lt;- function(
  niter = 1000, # number of iterations
  n = 6, # if vector then sample per group
  sigma_0 = 1, # error at time 0
  sigma_1 = 1, # error at time 1
  rho = 0.6, # correlation between time 0 and 1
  beta_0 = 10, # control mean at time 0
  beta_1 = 1, # treatment effect at time 1
  beta_2 = 5 # time effect at time 1
){
  
  if(length(n) == 1){n &lt;- rep(n,2)} # set n = n for all groups
  method_list &lt;- c(&quot;lm_cov&quot;, &quot;clda&quot;, &quot;lmm&quot;, &quot;rmanova&quot;)
  prob_wide &lt;- data.table(matrix(-9999, nrow=niter, ncol=length(method_list)))
  colnames(prob_wide) &lt;- method_list
  for(iter in 1:niter){
    fd &lt;- generate_pre_post(
      n = n,
      sigma_0 = sigma_0,
      sigma_1 = sigma_1,
      rho = rho, 
      beta_0 = beta_0, 
      beta_1 = beta_1 
    )
    
    fd_long &lt;- wide_to_long(fd,
                            measure_prefix = &quot;glucose&quot;
    )
    
    m1 &lt;- lm_cov(fd)
    m2 &lt;- clda1(fd_long)
    m3 &lt;- clda2(fd_long)
    m4 &lt;- lmm(fd_long)
    m5 &lt;- two_way(fd_long)
    m6 &lt;- rmanova(fd_long)
    
    prob_wide[iter, lm_cov := coef(summary(m1))[&quot;treatmenttr&quot;, &quot;Pr(&gt;|t|)&quot;]]
    prob_wide[iter, clda := coef(summary(m2))[&quot;timeglucose_1_treatmenttr&quot;, &quot;p-value&quot;]]
    prob_wide[iter, lmm := coef(summary(m4))[&quot;timeglucose_1:treatmenttr&quot;, &quot;p-value&quot;]]
    prob_wide[iter, rmanova := summary(m6)$univariate.tests[&quot;treatment:time&quot;, &quot;Pr(&gt;F)&quot;]]
    
  }
  
  prob &lt;- melt(prob_wide,
               id.vars = NULL,
               measure.vars = method_list,
               variable.name = &quot;method&quot;,
               value.name = &quot;p_value&quot;)
  return(prob)
}</code></pre>
</div>
<div id="summary-statistics" class="section level2">
<h2>Summary statistics</h2>
<pre class="r"><code>p_summary &lt;- function(prob, niter){
  prob_summary &lt;- prob[, .(freq_lt_05 = sum(p_value &lt; 0.05)/max(niter)),
          by = .(method)]
  return(prob_summary)
}</code></pre>
</div>
<div id="plot" class="section level2">
<h2>Plot:</h2>
<pre class="r"><code>plot_it &lt;- function(prob){
  jco_pal &lt;- pal_jco()(6)
  group_colors &lt;- jco_pal[c(2,5,4,6)]
  group_shapes &lt;- c(15, 16, 17,  18)
  
  pd &lt;- position_dodge(0.8)
  gg1 &lt;- ggplot(data = prob,
                aes(x=method, y=freq_lt_05, color=method, shape=method)) +
    geom_point(position = pd) +
    scale_color_manual(values = group_colors) +
    scale_shape_manual(values = group_shapes) +
    ylab(&quot;Frequency p &lt; 0.05&quot;) +
    xlab(&quot;&quot;) +
    theme_pubr() +
    theme(legend.position=&quot;none&quot;) +
    guides(col = guide_legend(ncol = 5, byrow = FALSE)) +
    NULL
  return(gg1)
}</code></pre>
</div>
<div id="type-i-error" class="section level2">
<h2>Type I error</h2>
<pre class="r"><code># parameters of simulation
  niter = 1000 # number of iterations
  n = 6 # if vector then sample per group
  sigma_0 = 1 # error at time 0
  sigma_1 = 1 # error at time 1
  rho = 0.6 # correlation between time 0 and 1
  beta_0 = 10 # control mean at time 0
  beta_1 = 0 # treatment effect at time 1
  beta_2 = 5 # time effect at time 1
  
  prob_type1 &lt;- simulate_pre_post(niter = niter,
                                  n = n,
                                  sigma_0 = sigma_0,
                                  sigma_1 = sigma_1,
                                  rho = rho,
                                  beta_0 = beta_0,
                                  beta_1 = beta_1,
                                  beta_2 = beta_2)

prob_type1_sum &lt;- p_summary(prob_type1, niter)</code></pre>
</div>
<div id="power" class="section level2">
<h2>Power</h2>
<pre class="r"><code># parameters of simulation
  niter = 1000 # number of iterations
  n = 6 # if vector then sample per group
  sigma_0 = 1 # error at time 0
  sigma_1 = 1 # error at time 1
  rho = 0.6 # correlation between time 0 and 1
  beta_0 = 10 # control mean at time 0
  beta_1 = 1 # treatment effect at time 1
  beta_2 = 5 # time effect at time 1

  prob_power &lt;- simulate_pre_post(niter = niter,
                              n = n,
                              sigma_0 = sigma_0,
                              sigma_1 = sigma_1,
                              rho = rho,
                              beta_0 = beta_0,
                              beta_1 = beta_1,
                              beta_2 = beta_2)
  
  prob_power_sum &lt;- p_summary(prob_power, niter)</code></pre>
</div>
</div>
<div id="tables" class="section level1">
<h1>Tables</h1>
<div id="type-i-error-rates" class="section level2">
<h2>Type I error rates</h2>
<pre class="r"><code>table1 &lt;- prob_type1_sum
colnames(table1)[2] &lt;- &quot;Type I error rate&quot;
knitr::kable(table1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">method</th>
<th align="right">Type I error rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lm_cov</td>
<td align="right">0.055</td>
</tr>
<tr class="even">
<td align="left">clda</td>
<td align="right">0.099</td>
</tr>
<tr class="odd">
<td align="left">lmm</td>
<td align="right">0.040</td>
</tr>
<tr class="even">
<td align="left">rmanova</td>
<td align="right">0.040</td>
</tr>
</tbody>
</table>
</div>
<div id="power-1" class="section level2">
<h2>Power</h2>
<pre class="r"><code>table2 &lt;- prob_power_sum
colnames(table2)[2] &lt;- &quot;Power&quot;
knitr::kable(table2, digits = 2)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">method</th>
<th align="right">Power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">lm_cov</td>
<td align="right">0.43</td>
</tr>
<tr class="even">
<td align="left">clda</td>
<td align="right">0.57</td>
</tr>
<tr class="odd">
<td align="left">lmm</td>
<td align="right">0.41</td>
</tr>
<tr class="even">
<td align="left">rmanova</td>
<td align="right">0.41</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="plots" class="section level1">
<h1>Plots</h1>
<pre class="r"><code>gg_a &lt;- plot_it(prob_type1_sum)
gg_b &lt;- plot_it(prob_power_sum)
plot_grid(gg_a, gg_b, ncol=2)</code></pre>
<p><img src="/post/2020-03-19-analyzing-longitudinal-data-a-simple-pre-post-design_files/figure-html/plots-1.png" width="672" /></p>
</div>

              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">TAGGED IN</span><br/>
                    
  <a class="tag tag--primary tag--small" href="/tags/ancova/">ancova</a>

  <a class="tag tag--primary tag--small" href="/tags/fake-data/">fake data</a>

  <a class="tag tag--primary tag--small" href="/tags/linear-mixed-model/">linear mixed model</a>

  <a class="tag tag--primary tag--small" href="/tags/nhst/">NHST</a>

  <a class="tag tag--primary tag--small" href="/tags/power/">power</a>

  <a class="tag tag--primary tag--small" href="/tags/pre-post/">pre-post</a>

  <a class="tag tag--primary tag--small" href="/tags/clda/">clda</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/04/melting-a-list-of-columns/" data-tooltip="Melting a list of columns">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/02/using-wright-s-rules-and-a-dag-to-compute-the-bias-of-an-effect-when-we-measure-proxies-for-x-and-y/" data-tooltip="Using Wright&#39;s rules and a DAG to compute the bias of an effect when we measure proxies for X and Y">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
                <div id="disqus_thread">
  <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 <a href="https://github.com/middleprofessor">Jeffrey A. Walker</a>. All Rights Reserved
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="4">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/04/melting-a-list-of-columns/" data-tooltip="Melting a list of columns">
              
                  <i class="fa fa-angle-left"></i>
                  <span class="hide-xs hide-sm text-small icon-ml">NEXT</span>
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="/2020/02/using-wright-s-rules-and-a-dag-to-compute-the-bias-of-an-effect-when-we-measure-proxies-for-x-and-y/" data-tooltip="Using Wright&#39;s rules and a DAG to compute the bias of an effect when we measure proxies for X and Y">
              
                  <span class="hide-xs hide-sm text-small icon-mr">PREVIOUS</span>
                  <i class="fa fa-angle-right"></i>
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
        <li class="post-action hide-lg hide-md hide-sm">
          <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions">
            <i class="fa fa-share-alt"></i>
          </a>
        </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-facebook-official"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-twitter"></i>
            </a>
          </li>
        
          <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
              <i class="fa fa-google-plus"></i>
            </a>
          </li>
        
      
      
        <li class="post-action">
          <a class="post-action-btn btn btn--default" href="#disqus_thread">
            <i class="fa fa-comment-o"></i>
          </a>
        </li>
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="4">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=%2F2020%2F03%2Fanalyzing-longitudinal-data-a-simple-pre-post-design%2F">
          <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=%2F2020%2F03%2Fanalyzing-longitudinal-data-a-simple-pre-post-design%2F">
          <i class="fa fa-twitter"></i><span>Share on Twitter</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=%2F2020%2F03%2Fanalyzing-longitudinal-data-a-simple-pre-post-design%2F">
          <i class="fa fa-google-plus"></i><span>Share on Google&#43;</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="/images/fire.png" alt="Author&#39;s picture" />
    
    <h4 id="about-card-name">R doodles. Some ecology. Some physiology. Much fake data.</h4>
    
      <div id="about-card-bio">Thoughts on R, statistical best practices, and teaching applied statistics to Biology majors.</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Jeff Walker, Professor of Biological Sciences
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        University of Southern Maine, Portland, Maine, United States
      </div>
    
  </div>
</div>

    <div id="algolia-search-modal" class="modal-container">
  <div class="modal">
    <div class="modal-header">
      <span class="close-button"><i class="fa fa-close"></i></span>
      <a href="https://algolia.com" target="_blank" rel="noopener" class="searchby-algolia text-color-light link-unstyled">
        <span class="searchby-algolia-text text-color-light text-small">by</span>
        <img class="searchby-algolia-logo" src="https://www.algolia.com/static_assets/images/press/downloads/algolia-light.svg">
      </a>
      <i class="search-icon fa fa-search"></i>
      <form id="algolia-search-form">
        <input type="text" id="algolia-search-input" name="search"
          class="form-control input--large search-input" placeholder="Search" />
      </form>
    </div>
    <div class="modal-body">
      <div class="no-result text-color-light text-center">no post found</div>
      <div class="results">
        
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/04/melting-a-list-of-columns/">
                <h3 class="media-heading">Melting a list of columns</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Apr 4, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">An answer to this tweet “Are there any #Rstats tidy expeRts who’d be interested in improving the efficiency of this code that gathers multiple variables from wide to long?
This works but it’s not pretty. There must be a prettier way…&quot;
Wide data frame has three time points where participants answer two questions on two topics.
create data from original code #Simmed data Time1.Topic1.Question1 &lt;- rnorm(500) data &lt;- data.frame(Time1.Topic1.Question1) data$Time1.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/03/analyzing-longitudinal-data-a-simple-pre-post-design/">
                <h3 class="media-heading">Analyzing longitudinal data -- a simple pre-post design</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Mar 3, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">A skeletal response to a twitter question:
“ANOVA (time point x group) or ANCOVA (group with time point as a covariate) for intervention designs? Discuss.”
follow-up “Only 2 time points in this case (pre- and post-intervention), and would wanna basically answer the question of whether out of the 3 intervention groups, some improve on measure X more than others after the intervention”
Here I compare five methods using fake pre-post data, including</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2020/02/using-wright-s-rules-and-a-dag-to-compute-the-bias-of-an-effect-when-we-measure-proxies-for-x-and-y/">
                <h3 class="media-heading">Using Wright&#39;s rules and a DAG to compute the bias of an effect when we measure proxies for X and Y</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Feb 2, 2020
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This is a skeletal post to work up an answer to a twitter question using Wright’s rules of path models. Using this figure
from Panel A of a figure from Hernan and Cole. The scribbled red path coefficients are added
 the question is I want to know about A-&gt;Y but I measure A* and Y*. So in figure A, is the bias the backdoor path from A* to Y* through A and Y?</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/11/nested-random-factors-in-mixed-multilevel-or-hierarchical-models/">
                <h3 class="media-heading">&#34;Nested&#34; random factors in mixed (multilevel or hierarchical) models</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Setup Import Models as nested using “tank” nested within “room” as two random intercepts (using lme4 to create the combinations) A safer (lme4) way to create the combinations of “room” and “tank”: as two random intercepts using “tank2” Don’t do this    This is a skeletal post to show the equivalency of different ways of thinking about “nested” factors in a mixed model. The data are measures of life history traits in lice that infect salmon.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/11/estimate-of-marginal-main-effects-instead-of-anova-for-factorial-experiments/">
                <h3 class="media-heading">Estimate of marginal (&#34;main&#34;) effects instead of ANOVA for factorial experiments</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Nov 11, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Background Comparing marginal effects to main effect terms in an ANOVA table First, some fake data Comparison of marginal effects vs. “main” effects term of ANOVA table when data are balanced Comparison of marginal effects vs. “main” effects term of ANOVA table when data are unbalanced  When to estimate marginal effects   keywords: estimation, ANOVA, factorial, model simplification, conditional effects, marginal effects
Background I recently read a paper from a very good ecology journal that communicated the results of an ANOVA like that below (Table 1) using a statement similar to “The removal of crabs strongly decreased algae cover (\(F_{1,36} = 17.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/can-a-linear-model-reproduce-a-welch-t-test/">
                <h3 class="media-heading">Can a linear model reproduce a Welch t-test?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">This doodle was motivated Jake Westfall’s answer to a Cross-Validated question.
The short answer is yes but most R scripts that I’ve found on the web are unsatisfying because only the t-value reproduces, not the df and p-value. Jake notes the reason for this in his answer on Cross-Validated.
To get the adjusted df, and the p-value associated with this, one can use the emmeans package by Russell Lenth, as he notes here.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/normalization-results-in-regression-to-the-mean/">
                <h3 class="media-heading">Normalization results in regression to the mean and inflated Type I error conditional on the reference values</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Fig 1C of the Replication Study: Melanoma exosomes educate bone marrow progenitor cells toward a pro-metastatic phenotype through MET uses an odd (to me) three stage normalization procedure for the quantified western blots. The authors compared blot values between a treatment (shMet cells) and a control (shScr cells) using GAPDH to normalize the values. The three stages of the normalization are
first, the value for the Antibody levels were normalized by the value of a reference (GAPDH) for each Set.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/10/a-comment-on-the-novel-transformation-of-the-response-in-senolytics-decrease-senescent-cells-in-humans-preliminary-report-from-a-clinical-trial-of-dasatinib-plus-quercetin-in-individuals-with-diabetic-kidney-disease/">
                <h3 class="media-heading">A comment on the novel transformation of the response in &#34; Senolytics decrease senescent cells in humans: Preliminary report from a clinical trial of Dasatinib plus Quercetin in individuals with diabetic kidney disease&#34;</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Oct 10, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Motivation: https://pubpeer.com/publications/8DF6E66FEFAA2C3C7D5BD9C3FC45A2#2 and https://twitter.com/CGATist/status/1175015246282539009
tl;dr: Given the transformation done by the authors, for any response in day_0 that is unusually small, there is automatically a response in day_14 that is unusually big and vice-versa. Consequently, if the mean for day_0 is unusually small, the mean for day_14 is automatically unusually big, hence the elevated type I error with an unpaired t-test. The transformation is necessary and sufficient to produce the result (meaning even in conditions where a paired t-test isn’t needed, the transformation still produces elevated Type I error).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/08/what-is-the-consequence-of-a-shapiro-wilk-test-of-normality-filter-on-type-i-error-and-power/">
                <h3 class="media-heading">What is the consequence of a Shapiro-Wilk test-of-normality filter on Type I error and Power?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Aug 8, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Set up Normal distribution Type I error Power  Right skewed continuous – lognormal What the parameterizations look like Type I error Power    This 1990-wants-you-back doodle explores the effects of a Normality Filter – using a Shapiro-Wilk (SW) test as a decision rule for using either a t-test or some alternative such as a 1) non-parametric Mann-Whitney-Wilcoxon (MWW) test, or 2) a t-test on the log-transformed response.</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
          <div class="media">
            
            <div class="media-body">
              <a class="link-unstyled" href="/2019/07/what-is-bias-in-the-estimation-of-an-effect-giving-an-omitted-interaction-term/">
                <h3 class="media-heading">What is the bias in the estimation of an effect given an omitted interaction term?</h3>
              </a>
              <span class="media-meta">
                <span class="media-date text-small">
                  Jul 7, 2019
                </span>
              </span>
              <div class="media-content hide-xs font-merryweather">Some background (due to Sewall Wright’s method of path analysis) Given a generating model:
\[\begin{equation} y = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \beta_3 x_3 \end{equation}\] where \(x_3 = x_1 x_2\); that is, it is an interaction variable.
The total effect of \(x_1\) on \(y\) is \(\beta_1 + \frac{\mathrm{COV}(x_1, x_2)}{\mathrm{VAR}(x_1)} \beta_2 + \frac{\mathrm{COV}(x_1, x_3)}{\mathrm{VAR}(x_1)} \beta_3\).
If \(x_3\) (the interaction) is missing, its component on the total efffect is added to the coefficient of \(x_1\).</div>
            </div>
            <div style="clear:both;"></div>
            <hr>
          </div>
        
      </div>
    </div>
    <div class="modal-footer">
      <p class="results-count text-medium"
         data-message-zero="no post found"
         data-message-one="1 post found"
         data-message-other="{n} posts found">
         38 posts found
      </p>
    </div>
  </div>
</div>
    
  
    
    <div id="cover" style="background-image:url('/images/Jackson%20copy%202.jpg');"></div>
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="/js/script-qi9wbxp2ya2j6p7wx1i6tgavftewndznf4v0hy2gvivk1rxgc3lm7njqb6bz.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
      <script>
        var disqus_config = function () {
          this.page.url = '\/2020\/03\/analyzing-longitudinal-data-a-simple-pre-post-design\/';
          
            this.page.identifier = '\/2020\/03\/analyzing-longitudinal-data-a-simple-pre-post-design\/'
          
        };
        (function() {
          
          
          if (window.location.hostname == "localhost") {
            return;
          }
          var d = document, s = d.createElement('script');
          var disqus_shortname = 'r-doodles';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    
  



<script src="//yihui.name/js/math-code.js"></script>
<script async
src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
    
  </body>
</html>

