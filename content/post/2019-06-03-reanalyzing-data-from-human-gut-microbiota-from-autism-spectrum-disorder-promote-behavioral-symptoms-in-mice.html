---
title: Reanalyzing data from Human Gut Microbiota from Autism Spectrum Disorder Promote
  Behavioral Symptoms in Mice
author: Jeff Walker
date: '2019-06-03'
slug: reanalyzing-data-from-human-gut-microbiota-from-autism-spectrum-disorder-promote-behavioral-symptoms-in-mice
categories:
  - reproducibility
tags:
  - linear mixed model
  - microbiome
---



<p>A very skeletal analysis of</p>
<p>Sharon, G., Cruz, N.J., Kang, D.W., Gandal, M.J., Wang, B., Kim, Y.M., Zink, E.M., Casey, C.P., Taylor, B.C., Lane, C.J. and Bramer, L.M., 2019. Human Gut Microbiota from Autism Spectrum Disorder Promote Behavioral Symptoms in Mice. Cell, 177(6), pp.1600-1618.</p>
<p><a href="https://pubpeer.com/publications/B521D325772244D8F656F1ED193ACA#">which got some attention on pubpeer</a>.</p>
<p>Commenters are questioning the result of Fig1G. It is very hard to infer a p-value from plots like these, where the data are multi-level, regardless of if means and some kind of error bar is presented. A much better plot for inferring differences is an effects plot with the CI of the effect. That said, I’ll try to reproduce the resulting p-value.</p>
<div id="caveats" class="section level1">
<h1>Caveats</h1>
<p>Failure to reproduce or partial reproducibility might be an error in my coding, or my misunderstanding of the author’s methods, or my lack of knowledge of statistics generally or the R functions that I use more specifically.</p>
<pre class="r"><code>library(ggplot2)
library(lmerTest)
library(emmeans)
library(lmtest)
library(data.table)</code></pre>
<pre class="r"><code>data_path &lt;- &quot;../data/Data from Human Gut Microbiota from Autism Spectrum Disorder Promote Behavioral Symptoms in Mice/Fig1&quot;
#data_path &lt;- &quot;data/Data from Human Gut Microbiota from Autism Spectrum Disorder Promote Behavioral Symptoms in Mice/Fig1&quot;</code></pre>
<pre class="r"><code>fn &lt;- &quot;Fig1EFGH_subset8.csv&quot;
file_path &lt;- paste(data_path, fn, sep=&quot;/&quot;)
mouse &lt;- fread(file_path)
mouse[, ASD_diagnosis:=factor(ASD_diagnosis, c(&quot;NT&quot;, &quot;ASD&quot;))]</code></pre>
</div>
<div id="figure-1g" class="section level1">
<h1>Figure 1G</h1>
<div id="method-no.-1-as-stated-in-caption-to-fig-1" class="section level2">
<h2>Method no. 1 (as stated in caption to Fig 1)</h2>
<p>The figure caption gives the method as “Hypothesis testing for differences of the means were done by a mixed effects analysis using donor diagnosis and mouse sex as fixed effects and donor ID as a random effect. p values were derived from a chi-square test”. This would be a Likelihood Ratio Test (LRT). The LRT requires that the model be fit by maximum likelhood for the statistic to have any meaning. The default fit in R is REML.</p>
<p>Estimate of marginal means</p>
<pre class="r"><code>m1 &lt;- lmer(OFT_Distance ~ ASD_diagnosis + (1|Donor), data=mouse)
(emmeans(m1, specs=c(&quot;ASD_diagnosis&quot;)))</code></pre>
<pre><code>##  ASD_diagnosis emmean  SE   df lower.CL upper.CL
##  NT              4600 262 5.70     3951     5249
##  ASD             4235 206 6.08     3731     4738
## 
## Degrees-of-freedom method: kenward-roger 
## Confidence level used: 0.95</code></pre>
<p>and effect, standardized to cohen’s D using residual standard deviation from model: (NT - ASD)/sigma</p>
<pre class="r"><code>coef(summary(m1))[&quot;ASD_diagnosisASD&quot;, &quot;Estimate&quot;]/sigma(m1)</code></pre>
<pre><code>## [1] -0.3928202</code></pre>
<p>The reported cohen’s D for the distance traveled is doTD-oASD = -0.58</p>
<p>The LRT of the model as specified in the caption of Fig1G</p>
<pre class="r"><code># correct LRT
m1 &lt;- lmer(OFT_Distance ~ Gender + ASD_diagnosis + (1|Donor), REML=FALSE, data=mouse)
anova(m1)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                Sum Sq Mean Sq NumDF   DenDF F value Pr(&gt;F)
## Gender         665003  665003     1 200.288  0.7706 0.3811
## ASD_diagnosis 1388695 1388695     1   8.403  1.6091 0.2386</code></pre>
<pre class="r"><code>m2 &lt;- lmer(OFT_Distance ~ Gender + (1|Donor), REML=FALSE, data=mouse)
lrtest(m2, m1)</code></pre>
<pre><code>## Likelihood ratio test
## 
## Model 1: OFT_Distance ~ Gender + (1 | Donor)
## Model 2: OFT_Distance ~ Gender + ASD_diagnosis + (1 | Donor)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)
## 1   4 -1706.7                     
## 2   5 -1706.0  1 1.4994     0.2208</code></pre>
<p>The p-value is .2208</p>
<p>The LRT of the model as specified but using the default lmer settings, which is fit by REML, which results in a meaningless chisq statistic</p>
<pre class="r"><code># incorrect LRT
# correct LRT
m1 &lt;- lmer(OFT_Distance ~ Gender + ASD_diagnosis + (1|Donor), data=mouse)
anova(m1)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                Sum Sq Mean Sq NumDF   DenDF F value Pr(&gt;F)
## Gender         628519  628519     1 198.647  0.7242 0.3958
## ASD_diagnosis 1094412 1094412     1   6.256  1.2609 0.3027</code></pre>
<pre class="r"><code>m2 &lt;- lmer(OFT_Distance ~ Gender + (1|Donor), data=mouse)
lrtest(m2, m1)</code></pre>
<pre><code>## Likelihood ratio test
## 
## Model 1: OFT_Distance ~ Gender + (1 | Donor)
## Model 2: OFT_Distance ~ Gender + ASD_diagnosis + (1 | Donor)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   4 -1695.0                         
## 2   5 -1687.6  1 14.692  0.0001266 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>the p-value is 0.00013. Is this the reported p-value? Note in the “methods” the authors write:</p>
</div>
<div id="method-no.-2-as-stated-in-methods-section" class="section level2">
<h2>method no. 2 (as stated in methods section)</h2>
<p>“Statistical analysis for behavioral outcomes in fecal transplanted offspring. Comparison of behavioral outcomes between TD Controls and ASD donors were tested using longitudinal linear mixed effects analyses, with test cycles and donors treated as repeated factors. Analyses were performed in SPSS (v 24); a priori alpha = 0.05. All outcomes were tested for normality and transformed as required. Diagonal covariance matrices were used so that intra-cycle and intra-donor correlations were accounted for in the modeling. The donor type (TD versus ASD) was the primary fixed effect measured, and mouse sex was an a priori covariate.”</p>
<p>(I think) it would be unlikely to get the wrong LRT using SPSS. Also the specified model differs from that in the caption. Was the response transformed (note it’s not the reponse that needs to be “normal” but the residuals from the linear model (or equivalently the conditional response))</p>
<p>correct LRT</p>
<pre class="r"><code># correct LRT
m1 &lt;- lmer(OFT_Distance ~ Gender + ASD_diagnosis + (1|Cycle) + (1|Donor), REML=FALSE, data=mouse)</code></pre>
<pre><code>## boundary (singular) fit: see ?isSingular</code></pre>
<pre class="r"><code>anova(m1)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                Sum Sq Mean Sq NumDF   DenDF F value Pr(&gt;F)
## Gender         665004  665004     1 200.288  0.7706 0.3811
## ASD_diagnosis 1388697 1388697     1   8.403  1.6091 0.2386</code></pre>
<pre class="r"><code>m2 &lt;- lmer(OFT_Distance ~ Gender + (1|Cycle) + (1|Donor), REML=FALSE, data=mouse)
lrtest(m2, m1)</code></pre>
<pre><code>## Likelihood ratio test
## 
## Model 1: OFT_Distance ~ Gender + (1 | Cycle) + (1 | Donor)
## Model 2: OFT_Distance ~ Gender + ASD_diagnosis + (1 | Cycle) + (1 | Donor)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)
## 1   5 -1706.7                     
## 2   6 -1706.0  1 1.4974     0.2211</code></pre>
<p>incorrect LRT</p>
<pre class="r"><code># correct LRT
m1 &lt;- lmer(OFT_Distance ~ Gender + ASD_diagnosis + (1|Cycle) + (1|Donor), data=mouse)
anova(m1)</code></pre>
<pre><code>## Type III Analysis of Variance Table with Satterthwaite&#39;s method
##                Sum Sq Mean Sq NumDF   DenDF F value Pr(&gt;F)
## Gender         603760  603760     1 198.479  0.6967 0.4049
## ASD_diagnosis 1065188 1065188     1   6.221  1.2291 0.3086</code></pre>
<pre class="r"><code>m2 &lt;- lmer(OFT_Distance ~ Gender + (1|Cycle) + (1|Donor), data=mouse)
lrtest(m2, m1)</code></pre>
<pre><code>## Likelihood ratio test
## 
## Model 1: OFT_Distance ~ Gender + (1 | Cycle) + (1 | Donor)
## Model 2: OFT_Distance ~ Gender + ASD_diagnosis + (1 | Cycle) + (1 | Donor)
##   #Df  LogLik Df  Chisq Pr(&gt;Chisq)    
## 1   5 -1694.9                         
## 2   6 -1687.6  1 14.663  0.0001286 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Basically the same results</p>
</div>
</div>
